{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "58639e08",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\justb\\anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py:3165: DtypeWarning: Columns (15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,56,58,60,62,64) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Nature</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Date - Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCO Nucléaire (%)</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>52</td>\n",
       "      <td>Pays de la Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>24</td>\n",
       "      <td>Centre-Val de Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28</td>\n",
       "      <td>Normandie</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>44</td>\n",
       "      <td>Grand Est</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 65 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Code INSEE région                   Région               Nature  \\\n",
       "0                 52         Pays de la Loire  Données définitives   \n",
       "1                 24      Centre-Val de Loire  Données définitives   \n",
       "2                 28                Normandie  Données définitives   \n",
       "3                 27  Bourgogne-Franche-Comté  Données définitives   \n",
       "4                 44                Grand Est  Données définitives   \n",
       "\n",
       "         Date  Heure               Date - Heure  Consommation (MW)  \\\n",
       "0  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "1  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "2  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "3  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "4  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "\n",
       "   Thermique (MW)  Nucléaire (MW)  Eolien (MW)  ...  TCO Nucléaire (%)  \\\n",
       "0             NaN             NaN          NaN  ...                NaN   \n",
       "1             NaN             NaN          NaN  ...                NaN   \n",
       "2             NaN             NaN          NaN  ...                NaN   \n",
       "3             NaN             NaN          NaN  ...                NaN   \n",
       "4             NaN             NaN          NaN  ...                NaN   \n",
       "\n",
       "   TCH Nucléaire (%)  TCO Eolien (%)  TCH Eolien (%)  TCO Solaire (%)  \\\n",
       "0                NaN             NaN             NaN              NaN   \n",
       "1                NaN             NaN             NaN              NaN   \n",
       "2                NaN             NaN             NaN              NaN   \n",
       "3                NaN             NaN             NaN              NaN   \n",
       "4                NaN             NaN             NaN              NaN   \n",
       "\n",
       "  TCH Solaire (%) TCO Hydraulique (%) TCH Hydraulique (%) TCO Bioénergies (%)  \\\n",
       "0             NaN                 NaN                 NaN                 NaN   \n",
       "1             NaN                 NaN                 NaN                 NaN   \n",
       "2             NaN                 NaN                 NaN                 NaN   \n",
       "3             NaN                 NaN                 NaN                 NaN   \n",
       "4             NaN                 NaN                 NaN                 NaN   \n",
       "\n",
       "  TCH Bioénergies (%)  \n",
       "0                 NaN  \n",
       "1                 NaN  \n",
       "2                 NaN  \n",
       "3                 NaN  \n",
       "4                 NaN  \n",
       "\n",
       "[5 rows x 65 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Importer le fichier et afficher les premières lignes :\n",
    "import pandas as pd\n",
    "%matplotlib inline\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "df=pd.read_csv('eco2mix-regional-cons-def.csv',sep =';')\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "ebfb141b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Nature</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Date - Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>52</td>\n",
       "      <td>Pays de la Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>24</td>\n",
       "      <td>Centre-Val de Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28</td>\n",
       "      <td>Normandie</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>44</td>\n",
       "      <td>Grand Est</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>00:00</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 66 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Code INSEE région                   Région               Nature  \\\n",
       "0                 52         Pays de la Loire  Données définitives   \n",
       "1                 24      Centre-Val de Loire  Données définitives   \n",
       "2                 28                Normandie  Données définitives   \n",
       "3                 27  Bourgogne-Franche-Comté  Données définitives   \n",
       "4                 44                Grand Est  Données définitives   \n",
       "\n",
       "         Date  Heure               Date - Heure  Consommation (MW)  \\\n",
       "0  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "1  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "2  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "3  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "4  2013-01-01  00:00  2013-01-01T00:00:00+01:00                NaN   \n",
       "\n",
       "   Thermique (MW)  Nucléaire (MW)  Eolien (MW)  ...  TCH Nucléaire (%)  \\\n",
       "0             NaN             NaN          NaN  ...                NaN   \n",
       "1             NaN             NaN          NaN  ...                NaN   \n",
       "2             NaN             NaN          NaN  ...                NaN   \n",
       "3             NaN             NaN          NaN  ...                NaN   \n",
       "4             NaN             NaN          NaN  ...                NaN   \n",
       "\n",
       "   TCO Eolien (%)  TCH Eolien (%)  TCO Solaire (%)  TCH Solaire (%)  \\\n",
       "0             NaN             NaN              NaN              NaN   \n",
       "1             NaN             NaN              NaN              NaN   \n",
       "2             NaN             NaN              NaN              NaN   \n",
       "3             NaN             NaN              NaN              NaN   \n",
       "4             NaN             NaN              NaN              NaN   \n",
       "\n",
       "  TCO Hydraulique (%) TCH Hydraulique (%) TCO Bioénergies (%)  \\\n",
       "0                 NaN                 NaN                 NaN   \n",
       "1                 NaN                 NaN                 NaN   \n",
       "2                 NaN                 NaN                 NaN   \n",
       "3                 NaN                 NaN                 NaN   \n",
       "4                 NaN                 NaN                 NaN   \n",
       "\n",
       "  TCH Bioénergies (%) Date_datetime  \n",
       "0                 NaN    2013-01-01  \n",
       "1                 NaN    2013-01-01  \n",
       "2                 NaN    2013-01-01  \n",
       "3                 NaN    2013-01-01  \n",
       "4                 NaN    2013-01-01  \n",
       "\n",
       "[5 rows x 66 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Création “Date_datetime” au format date :\n",
    "from datetime import datetime as dt\n",
    "\n",
    "df[\"Date_datetime\"]=pd.to_datetime(df.Date)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "153d013a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Nature</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Date - Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>52</td>\n",
       "      <td>Pays de la Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>24</td>\n",
       "      <td>Centre-Val de Loire</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28</td>\n",
       "      <td>Normandie</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>44</td>\n",
       "      <td>Grand Est</td>\n",
       "      <td>Données définitives</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 66 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Code INSEE région                   Région               Nature  \\\n",
       "0                 52         Pays de la Loire  Données définitives   \n",
       "1                 24      Centre-Val de Loire  Données définitives   \n",
       "2                 28                Normandie  Données définitives   \n",
       "3                 27  Bourgogne-Franche-Comté  Données définitives   \n",
       "4                 44                Grand Est  Données définitives   \n",
       "\n",
       "         Date  Heure               Date - Heure  Consommation (MW)  \\\n",
       "0  2013-01-01      0  2013-01-01T00:00:00+01:00                NaN   \n",
       "1  2013-01-01      0  2013-01-01T00:00:00+01:00                NaN   \n",
       "2  2013-01-01      0  2013-01-01T00:00:00+01:00                NaN   \n",
       "3  2013-01-01      0  2013-01-01T00:00:00+01:00                NaN   \n",
       "4  2013-01-01      0  2013-01-01T00:00:00+01:00                NaN   \n",
       "\n",
       "   Thermique (MW)  Nucléaire (MW)  Eolien (MW)  ...  TCH Nucléaire (%)  \\\n",
       "0             NaN             NaN          NaN  ...                NaN   \n",
       "1             NaN             NaN          NaN  ...                NaN   \n",
       "2             NaN             NaN          NaN  ...                NaN   \n",
       "3             NaN             NaN          NaN  ...                NaN   \n",
       "4             NaN             NaN          NaN  ...                NaN   \n",
       "\n",
       "   TCO Eolien (%)  TCH Eolien (%)  TCO Solaire (%)  TCH Solaire (%)  \\\n",
       "0             NaN             NaN              NaN              NaN   \n",
       "1             NaN             NaN              NaN              NaN   \n",
       "2             NaN             NaN              NaN              NaN   \n",
       "3             NaN             NaN              NaN              NaN   \n",
       "4             NaN             NaN              NaN              NaN   \n",
       "\n",
       "  TCO Hydraulique (%) TCH Hydraulique (%) TCO Bioénergies (%)  \\\n",
       "0                 NaN                 NaN                 NaN   \n",
       "1                 NaN                 NaN                 NaN   \n",
       "2                 NaN                 NaN                 NaN   \n",
       "3                 NaN                 NaN                 NaN   \n",
       "4                 NaN                 NaN                 NaN   \n",
       "\n",
       "  TCH Bioénergies (%) Date_datetime  \n",
       "0                 NaN    2013-01-01  \n",
       "1                 NaN    2013-01-01  \n",
       "2                 NaN    2013-01-01  \n",
       "3                 NaN    2013-01-01  \n",
       "4                 NaN    2013-01-01  \n",
       "\n",
       "[5 rows x 66 columns]"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#“Heure” au format heure\n",
    "from datetime import datetime as dt\n",
    "\n",
    "df[\"Heure\"]=df.Heure.astype(\"datetime64\")\n",
    "df[\"Heure\"]=df.Heure.dt.hour\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "78bc9d3c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Nature', 'Date', 'Heure',\n",
       "       'Date - Heure', 'Consommation (MW)', 'Thermique (MW)', 'Nucléaire (MW)',\n",
       "       'Eolien (MW)', 'Solaire (MW)', 'Hydraulique (MW)', 'Pompage (MW)',\n",
       "       'Bioénergies (MW)', 'Ech. physiques (MW)',\n",
       "       'Flux physiques d'Auvergne-Rhône-Alpes vers Grand-Est',\n",
       "       'Flux physiques de Bourgogne-Franche-Comté vers Grand-Est',\n",
       "       'Flux physiques de Bretagne vers Grand-Est',\n",
       "       'Flux physiques de Centre-Val de Loire vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est',\n",
       "       'Flux physiques de Hauts-de-France vers Grand-Est',\n",
       "       'Flux physiques d'Ile-de-France vers Grand-Est',\n",
       "       'Flux physiques de Normandie vers Grand-Est',\n",
       "       'Flux physiques de Nouvelle-Aquitaine vers Grand-Est',\n",
       "       'Flux physiques d'Occitanie vers Grand-Est',\n",
       "       'Flux physiques de Pays-de-la-Loire vers Grand-Est',\n",
       "       'Flux physiques de PACA vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Auvergne-Rhône-Alpes',\n",
       "       'Flux physiques de Grand-Est vers Bourgogne-Franche-Comté',\n",
       "       'Flux physiques de Grand-Est vers Bretagne',\n",
       "       'Flux physiques de Grand-Est vers Centre-Val de Loire',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est.1',\n",
       "       'Flux physiques de Grand-Est vers Hauts-de-France',\n",
       "       'Flux physiques de Grand-Est vers Ile-de-France',\n",
       "       'Flux physiques de Grand-Est vers Normandie',\n",
       "       'Flux physiques de Grand-Est vers Nouvelle-Aquitaine',\n",
       "       'Flux physiques de Grand-Est vers Occitanie',\n",
       "       'Flux physiques de Grand-Est vers Pays-de-la-Loire',\n",
       "       'Flux physiques de Grand-Est vers PACA',\n",
       "       'Flux physiques Allemagne vers Grand-Est',\n",
       "       'Flux physiques Belgique vers Grand-Est',\n",
       "       'Flux physiques Espagne vers Grand-Est',\n",
       "       'Flux physiques Italie vers Grand-Est',\n",
       "       'Flux physiques Luxembourg vers Grand-Est',\n",
       "       'Flux physiques Royaume-Uni vers Grand-Est',\n",
       "       'Flux physiques Suisse vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Allemagne',\n",
       "       'Flux physiques de Grand-Est vers Belgique',\n",
       "       'Flux physiques de Grand-Est vers Espagne',\n",
       "       'Flux physiques de Grand-Est vers Italie',\n",
       "       'Flux physiques de Grand-Est vers Luxembourg',\n",
       "       'Flux physiques de Grand-Est vers Royaume-Uni',\n",
       "       'Flux physiques de Grand-Est vers Suisse', 'TCO Thermique (%)',\n",
       "       'TCH Thermique (%)', 'TCO Nucléaire (%)', 'TCH Nucléaire (%)',\n",
       "       'TCO Eolien (%)', 'TCH Eolien (%)', 'TCO Solaire (%)',\n",
       "       'TCH Solaire (%)', 'TCO Hydraulique (%)', 'TCH Hydraulique (%)',\n",
       "       'TCO Bioénergies (%)', 'TCH Bioénergies (%)', 'Date_datetime'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "1f2aad7c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Code INSEE région               int64\n",
       "Région                         object\n",
       "Nature                         object\n",
       "Date                           object\n",
       "Heure                           int64\n",
       "                            ...      \n",
       "TCO Hydraulique (%)           float64\n",
       "TCH Hydraulique (%)            object\n",
       "TCO Bioénergies (%)           float64\n",
       "TCH Bioénergies (%)            object\n",
       "Date_datetime          datetime64[ns]\n",
       "Length: 66, dtype: object"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "b01b6ac5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1734912 entries, 0 to 1734911\n",
      "Data columns (total 66 columns):\n",
      " #   Column                                                    Dtype         \n",
      "---  ------                                                    -----         \n",
      " 0   Code INSEE région                                         int64         \n",
      " 1   Région                                                    object        \n",
      " 2   Nature                                                    object        \n",
      " 3   Date                                                      object        \n",
      " 4   Heure                                                     int64         \n",
      " 5   Date - Heure                                              object        \n",
      " 6   Consommation (MW)                                         float64       \n",
      " 7   Thermique (MW)                                            float64       \n",
      " 8   Nucléaire (MW)                                            float64       \n",
      " 9   Eolien (MW)                                               float64       \n",
      " 10  Solaire (MW)                                              float64       \n",
      " 11  Hydraulique (MW)                                          float64       \n",
      " 12  Pompage (MW)                                              float64       \n",
      " 13  Bioénergies (MW)                                          float64       \n",
      " 14  Ech. physiques (MW)                                       float64       \n",
      " 15  Flux physiques d'Auvergne-Rhône-Alpes vers Grand-Est      object        \n",
      " 16  Flux physiques de Bourgogne-Franche-Comté vers Grand-Est  object        \n",
      " 17  Flux physiques de Bretagne vers Grand-Est                 object        \n",
      " 18  Flux physiques de Centre-Val de Loire vers Grand-Est      object        \n",
      " 19  Flux physiques de Grand-Est vers Grand-Est                object        \n",
      " 20  Flux physiques de Hauts-de-France vers Grand-Est          object        \n",
      " 21  Flux physiques d'Ile-de-France vers Grand-Est             object        \n",
      " 22  Flux physiques de Normandie vers Grand-Est                object        \n",
      " 23  Flux physiques de Nouvelle-Aquitaine vers Grand-Est       object        \n",
      " 24  Flux physiques d'Occitanie vers Grand-Est                 object        \n",
      " 25  Flux physiques de Pays-de-la-Loire vers Grand-Est         object        \n",
      " 26  Flux physiques de PACA vers Grand-Est                     object        \n",
      " 27  Flux physiques de Grand-Est vers Auvergne-Rhône-Alpes     object        \n",
      " 28  Flux physiques de Grand-Est vers Bourgogne-Franche-Comté  object        \n",
      " 29  Flux physiques de Grand-Est vers Bretagne                 object        \n",
      " 30  Flux physiques de Grand-Est vers Centre-Val de Loire      object        \n",
      " 31  Flux physiques de Grand-Est vers Grand-Est.1              object        \n",
      " 32  Flux physiques de Grand-Est vers Hauts-de-France          object        \n",
      " 33  Flux physiques de Grand-Est vers Ile-de-France            object        \n",
      " 34  Flux physiques de Grand-Est vers Normandie                object        \n",
      " 35  Flux physiques de Grand-Est vers Nouvelle-Aquitaine       object        \n",
      " 36  Flux physiques de Grand-Est vers Occitanie                object        \n",
      " 37  Flux physiques de Grand-Est vers Pays-de-la-Loire         object        \n",
      " 38  Flux physiques de Grand-Est vers PACA                     object        \n",
      " 39  Flux physiques Allemagne vers Grand-Est                   object        \n",
      " 40  Flux physiques Belgique vers Grand-Est                    object        \n",
      " 41  Flux physiques Espagne vers Grand-Est                     object        \n",
      " 42  Flux physiques Italie vers Grand-Est                      object        \n",
      " 43  Flux physiques Luxembourg vers Grand-Est                  object        \n",
      " 44  Flux physiques Royaume-Uni vers Grand-Est                 object        \n",
      " 45  Flux physiques Suisse vers Grand-Est                      object        \n",
      " 46  Flux physiques de Grand-Est vers Allemagne                object        \n",
      " 47  Flux physiques de Grand-Est vers Belgique                 object        \n",
      " 48  Flux physiques de Grand-Est vers Espagne                  object        \n",
      " 49  Flux physiques de Grand-Est vers Italie                   object        \n",
      " 50  Flux physiques de Grand-Est vers Luxembourg               object        \n",
      " 51  Flux physiques de Grand-Est vers Royaume-Uni              object        \n",
      " 52  Flux physiques de Grand-Est vers Suisse                   object        \n",
      " 53  TCO Thermique (%)                                         float64       \n",
      " 54  TCH Thermique (%)                                         float64       \n",
      " 55  TCO Nucléaire (%)                                         float64       \n",
      " 56  TCH Nucléaire (%)                                         float64       \n",
      " 57  TCO Eolien (%)                                            float64       \n",
      " 58  TCH Eolien (%)                                            float64       \n",
      " 59  TCO Solaire (%)                                           float64       \n",
      " 60  TCH Solaire (%)                                           float64       \n",
      " 61  TCO Hydraulique (%)                                       float64       \n",
      " 62  TCH Hydraulique (%)                                       float64       \n",
      " 63  TCO Bioénergies (%)                                       float64       \n",
      " 64  TCH Bioénergies (%)                                       float64       \n",
      " 65  Date_datetime                                             datetime64[ns]\n",
      "dtypes: datetime64[ns](1), float64(21), int64(2), object(42)\n",
      "memory usage: 873.6+ MB\n"
     ]
    }
   ],
   "source": [
    "#Les variables “TCH” au format float\n",
    "df[\"TCH Thermique (%)\"]=pd.to_numeric(df[\"TCH Thermique (%)\"],errors=\"coerce\")\n",
    "df[\"TCH Nucléaire (%)\"]=pd.to_numeric(df[\"TCH Nucléaire (%)\"],errors=\"coerce\")\n",
    "df[\"TCH Eolien (%)\"]=pd.to_numeric(df[\"TCH Eolien (%)\"],errors=\"coerce\")\n",
    "df[\"TCH Solaire (%)\"]=pd.to_numeric(df[\"TCH Solaire (%)\"],errors=\"coerce\")\n",
    "df[\"TCH Hydraulique (%)\"]=pd.to_numeric(df[\"TCH Hydraulique (%)\"],errors=\"coerce\")\n",
    "df[\"TCH Bioénergies (%)\"]=pd.to_numeric(df[\"TCH Bioénergies (%)\"],errors=\"coerce\")\n",
    "\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "81b583a1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Date - Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>52</td>\n",
       "      <td>Pays de la Loire</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>24</td>\n",
       "      <td>Centre-Val de Loire</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28</td>\n",
       "      <td>Normandie</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>44</td>\n",
       "      <td>Grand Est</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:00:00+01:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 65 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Code INSEE région                   Région        Date  Heure  \\\n",
       "0                 52         Pays de la Loire  2013-01-01      0   \n",
       "1                 24      Centre-Val de Loire  2013-01-01      0   \n",
       "2                 28                Normandie  2013-01-01      0   \n",
       "3                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "4                 44                Grand Est  2013-01-01      0   \n",
       "\n",
       "                Date - Heure  Consommation (MW)  Thermique (MW)  \\\n",
       "0  2013-01-01T00:00:00+01:00                NaN             NaN   \n",
       "1  2013-01-01T00:00:00+01:00                NaN             NaN   \n",
       "2  2013-01-01T00:00:00+01:00                NaN             NaN   \n",
       "3  2013-01-01T00:00:00+01:00                NaN             NaN   \n",
       "4  2013-01-01T00:00:00+01:00                NaN             NaN   \n",
       "\n",
       "   Nucléaire (MW)  Eolien (MW)  Solaire (MW)  ...  TCH Nucléaire (%)  \\\n",
       "0             NaN          NaN           NaN  ...                NaN   \n",
       "1             NaN          NaN           NaN  ...                NaN   \n",
       "2             NaN          NaN           NaN  ...                NaN   \n",
       "3             NaN          NaN           NaN  ...                NaN   \n",
       "4             NaN          NaN           NaN  ...                NaN   \n",
       "\n",
       "   TCO Eolien (%)  TCH Eolien (%)  TCO Solaire (%) TCH Solaire (%)  \\\n",
       "0             NaN             NaN              NaN             NaN   \n",
       "1             NaN             NaN              NaN             NaN   \n",
       "2             NaN             NaN              NaN             NaN   \n",
       "3             NaN             NaN              NaN             NaN   \n",
       "4             NaN             NaN              NaN             NaN   \n",
       "\n",
       "  TCO Hydraulique (%) TCH Hydraulique (%) TCO Bioénergies (%)  \\\n",
       "0                 NaN                 NaN                 NaN   \n",
       "1                 NaN                 NaN                 NaN   \n",
       "2                 NaN                 NaN                 NaN   \n",
       "3                 NaN                 NaN                 NaN   \n",
       "4                 NaN                 NaN                 NaN   \n",
       "\n",
       "  TCH Bioénergies (%) Date_datetime  \n",
       "0                 NaN    2013-01-01  \n",
       "1                 NaN    2013-01-01  \n",
       "2                 NaN    2013-01-01  \n",
       "3                 NaN    2013-01-01  \n",
       "4                 NaN    2013-01-01  \n",
       "\n",
       "[5 rows x 65 columns]"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Supression de la variable “Nature”\n",
    "df=df.drop(\"Nature\", axis=1)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "4656d615",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Date - Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:30:00+01:00</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:30:00+01:00</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:30:00+01:00</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:30:00+01:00</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2013-01-01T00:30:00+01:00</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 65 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "                 Date - Heure  Consommation (MW)  Thermique (MW)  \\\n",
       "12  2013-01-01T00:30:00+01:00             3050.0            58.0   \n",
       "13  2013-01-01T00:30:00+01:00             5464.0           240.0   \n",
       "14  2013-01-01T00:30:00+01:00             9134.0           685.0   \n",
       "15  2013-01-01T00:30:00+01:00             2357.0           236.0   \n",
       "16  2013-01-01T00:30:00+01:00             8173.0           252.0   \n",
       "\n",
       "    Nucléaire (MW)  Eolien (MW)  Solaire (MW)  ...  TCH Nucléaire (%)  \\\n",
       "12             NaN        107.0           0.0  ...                NaN   \n",
       "13          4993.0        175.0           0.0  ...                NaN   \n",
       "14             NaN         16.0           0.0  ...                NaN   \n",
       "15             NaN        106.0           0.0  ...                NaN   \n",
       "16         12069.0        257.0           0.0  ...                NaN   \n",
       "\n",
       "    TCO Eolien (%)  TCH Eolien (%)  TCO Solaire (%) TCH Solaire (%)  \\\n",
       "12             NaN             NaN              NaN             NaN   \n",
       "13             NaN             NaN              NaN             NaN   \n",
       "14             NaN             NaN              NaN             NaN   \n",
       "15             NaN             NaN              NaN             NaN   \n",
       "16             NaN             NaN              NaN             NaN   \n",
       "\n",
       "   TCO Hydraulique (%) TCH Hydraulique (%) TCO Bioénergies (%)  \\\n",
       "12                 NaN                 NaN                 NaN   \n",
       "13                 NaN                 NaN                 NaN   \n",
       "14                 NaN                 NaN                 NaN   \n",
       "15                 NaN                 NaN                 NaN   \n",
       "16                 NaN                 NaN                 NaN   \n",
       "\n",
       "   TCH Bioénergies (%) Date_datetime  \n",
       "12                 NaN    2013-01-01  \n",
       "13                 NaN    2013-01-01  \n",
       "14                 NaN    2013-01-01  \n",
       "15                 NaN    2013-01-01  \n",
       "16                 NaN    2013-01-01  \n",
       "\n",
       "[5 rows x 65 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Supression de la variable des lignes  01-01-2013  à 00H00 possède que des NA = 11 lignes en moins\n",
    "df=df.drop(df.index[0:12], axis=0)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "7c667d7b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Date', 'Heure', 'Date - Heure',\n",
       "       'Consommation (MW)', 'Thermique (MW)', 'Nucléaire (MW)', 'Eolien (MW)',\n",
       "       'Solaire (MW)', 'Hydraulique (MW)', 'Bioénergies (MW)',\n",
       "       'Ech. physiques (MW)',\n",
       "       'Flux physiques d'Auvergne-Rhône-Alpes vers Grand-Est',\n",
       "       'Flux physiques de Bourgogne-Franche-Comté vers Grand-Est',\n",
       "       'Flux physiques de Bretagne vers Grand-Est',\n",
       "       'Flux physiques de Centre-Val de Loire vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est',\n",
       "       'Flux physiques de Hauts-de-France vers Grand-Est',\n",
       "       'Flux physiques d'Ile-de-France vers Grand-Est',\n",
       "       'Flux physiques de Normandie vers Grand-Est',\n",
       "       'Flux physiques de Nouvelle-Aquitaine vers Grand-Est',\n",
       "       'Flux physiques d'Occitanie vers Grand-Est',\n",
       "       'Flux physiques de Pays-de-la-Loire vers Grand-Est',\n",
       "       'Flux physiques de PACA vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Auvergne-Rhône-Alpes',\n",
       "       'Flux physiques de Grand-Est vers Bourgogne-Franche-Comté',\n",
       "       'Flux physiques de Grand-Est vers Bretagne',\n",
       "       'Flux physiques de Grand-Est vers Centre-Val de Loire',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est.1',\n",
       "       'Flux physiques de Grand-Est vers Hauts-de-France',\n",
       "       'Flux physiques de Grand-Est vers Ile-de-France',\n",
       "       'Flux physiques de Grand-Est vers Normandie',\n",
       "       'Flux physiques de Grand-Est vers Nouvelle-Aquitaine',\n",
       "       'Flux physiques de Grand-Est vers Occitanie',\n",
       "       'Flux physiques de Grand-Est vers Pays-de-la-Loire',\n",
       "       'Flux physiques de Grand-Est vers PACA',\n",
       "       'Flux physiques Allemagne vers Grand-Est',\n",
       "       'Flux physiques Belgique vers Grand-Est',\n",
       "       'Flux physiques Espagne vers Grand-Est',\n",
       "       'Flux physiques Italie vers Grand-Est',\n",
       "       'Flux physiques Luxembourg vers Grand-Est',\n",
       "       'Flux physiques Royaume-Uni vers Grand-Est',\n",
       "       'Flux physiques Suisse vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Allemagne',\n",
       "       'Flux physiques de Grand-Est vers Belgique',\n",
       "       'Flux physiques de Grand-Est vers Espagne',\n",
       "       'Flux physiques de Grand-Est vers Italie',\n",
       "       'Flux physiques de Grand-Est vers Luxembourg',\n",
       "       'Flux physiques de Grand-Est vers Royaume-Uni',\n",
       "       'Flux physiques de Grand-Est vers Suisse', 'TCO Thermique (%)',\n",
       "       'TCH Thermique (%)', 'TCO Nucléaire (%)', 'TCH Nucléaire (%)',\n",
       "       'TCO Eolien (%)', 'TCH Eolien (%)', 'TCO Solaire (%)',\n",
       "       'TCH Solaire (%)', 'TCO Hydraulique (%)', 'TCH Hydraulique (%)',\n",
       "       'TCO Bioénergies (%)', 'TCH Bioénergies (%)', 'Date_datetime'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Supression de la variable “Pompage MW\"\n",
    "df=df.drop(\"Pompage (MW)\", axis=1)\n",
    "\n",
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "f8a9ddce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Nucléaire (%)</th>\n",
       "      <th>TCO Eolien (%)</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3079.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 63 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "    Consommation (MW)  Thermique (MW)  Nucléaire (MW)  Eolien (MW)  \\\n",
       "12             3050.0            58.0             NaN        107.0   \n",
       "13             5464.0           240.0          4993.0        175.0   \n",
       "14             9134.0           685.0             NaN         16.0   \n",
       "15             2357.0           236.0             NaN        106.0   \n",
       "16             8173.0           252.0         12069.0        257.0   \n",
       "\n",
       "    Solaire (MW)  Hydraulique (MW)  ...  TCH Nucléaire (%)  TCO Eolien (%)  \\\n",
       "12           0.0              86.0  ...                NaN             NaN   \n",
       "13           0.0             427.0  ...                NaN             NaN   \n",
       "14           0.0               0.0  ...                NaN             NaN   \n",
       "15           0.0             105.0  ...                NaN             NaN   \n",
       "16           0.0            3079.0  ...                NaN             NaN   \n",
       "\n",
       "   TCH Eolien (%) TCO Solaire (%) TCH Solaire (%) TCO Hydraulique (%)  \\\n",
       "12            NaN             NaN             NaN                 NaN   \n",
       "13            NaN             NaN             NaN                 NaN   \n",
       "14            NaN             NaN             NaN                 NaN   \n",
       "15            NaN             NaN             NaN                 NaN   \n",
       "16            NaN             NaN             NaN                 NaN   \n",
       "\n",
       "   TCH Hydraulique (%) TCO Bioénergies (%) TCH Bioénergies (%) Date_datetime  \n",
       "12                 NaN                 NaN                 NaN    2013-01-01  \n",
       "13                 NaN                 NaN                 NaN    2013-01-01  \n",
       "14                 NaN                 NaN                 NaN    2013-01-01  \n",
       "15                 NaN                 NaN                 NaN    2013-01-01  \n",
       "16                 NaN                 NaN                 NaN    2013-01-01  \n",
       "\n",
       "[5 rows x 63 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Supression de la variable “Date-heure”\n",
    "df=df.drop(\"Date - Heure\", axis=1)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "752a9a7c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Date', 'Heure', 'Consommation (MW)',\n",
       "       'Thermique (MW)', 'Nucléaire (MW)', 'Eolien (MW)', 'Solaire (MW)',\n",
       "       'Hydraulique (MW)', 'Bioénergies (MW)', 'Ech. physiques (MW)',\n",
       "       'Flux physiques d'Auvergne-Rhône-Alpes vers Grand-Est',\n",
       "       'Flux physiques de Bourgogne-Franche-Comté vers Grand-Est',\n",
       "       'Flux physiques de Bretagne vers Grand-Est',\n",
       "       'Flux physiques de Centre-Val de Loire vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est',\n",
       "       'Flux physiques de Hauts-de-France vers Grand-Est',\n",
       "       'Flux physiques d'Ile-de-France vers Grand-Est',\n",
       "       'Flux physiques de Normandie vers Grand-Est',\n",
       "       'Flux physiques de Nouvelle-Aquitaine vers Grand-Est',\n",
       "       'Flux physiques d'Occitanie vers Grand-Est',\n",
       "       'Flux physiques de Pays-de-la-Loire vers Grand-Est',\n",
       "       'Flux physiques de PACA vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Auvergne-Rhône-Alpes',\n",
       "       'Flux physiques de Grand-Est vers Bourgogne-Franche-Comté',\n",
       "       'Flux physiques de Grand-Est vers Bretagne',\n",
       "       'Flux physiques de Grand-Est vers Centre-Val de Loire',\n",
       "       'Flux physiques de Grand-Est vers Grand-Est.1',\n",
       "       'Flux physiques de Grand-Est vers Hauts-de-France',\n",
       "       'Flux physiques de Grand-Est vers Ile-de-France',\n",
       "       'Flux physiques de Grand-Est vers Normandie',\n",
       "       'Flux physiques de Grand-Est vers Nouvelle-Aquitaine',\n",
       "       'Flux physiques de Grand-Est vers Occitanie',\n",
       "       'Flux physiques de Grand-Est vers Pays-de-la-Loire',\n",
       "       'Flux physiques de Grand-Est vers PACA',\n",
       "       'Flux physiques Allemagne vers Grand-Est',\n",
       "       'Flux physiques Belgique vers Grand-Est',\n",
       "       'Flux physiques Espagne vers Grand-Est',\n",
       "       'Flux physiques Italie vers Grand-Est',\n",
       "       'Flux physiques Luxembourg vers Grand-Est',\n",
       "       'Flux physiques Royaume-Uni vers Grand-Est',\n",
       "       'Flux physiques Suisse vers Grand-Est',\n",
       "       'Flux physiques de Grand-Est vers Allemagne',\n",
       "       'Flux physiques de Grand-Est vers Belgique',\n",
       "       'Flux physiques de Grand-Est vers Espagne',\n",
       "       'Flux physiques de Grand-Est vers Italie',\n",
       "       'Flux physiques de Grand-Est vers Luxembourg',\n",
       "       'Flux physiques de Grand-Est vers Royaume-Uni',\n",
       "       'Flux physiques de Grand-Est vers Suisse', 'TCO Thermique (%)',\n",
       "       'TCH Thermique (%)', 'TCO Nucléaire (%)', 'TCH Nucléaire (%)',\n",
       "       'TCO Eolien (%)', 'TCH Eolien (%)', 'TCO Solaire (%)',\n",
       "       'TCH Solaire (%)', 'TCO Hydraulique (%)', 'TCH Hydraulique (%)',\n",
       "       'TCO Bioénergies (%)', 'TCH Bioénergies (%)', 'Date_datetime'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns\n",
    "#df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d7a7c8e4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Date', 'Heure', 'Consommation (MW)',\n",
       "       'Thermique (MW)', 'Nucléaire (MW)', 'Eolien (MW)', 'Solaire (MW)',\n",
       "       'Hydraulique (MW)', 'Bioénergies (MW)', 'Ech. physiques (MW)',\n",
       "       'TCO Thermique (%)', 'TCH Thermique (%)', 'TCO Nucléaire (%)',\n",
       "       'TCH Nucléaire (%)', 'TCO Eolien (%)', 'TCH Eolien (%)',\n",
       "       'TCO Solaire (%)', 'TCH Solaire (%)', 'TCO Hydraulique (%)',\n",
       "       'TCH Hydraulique (%)', 'TCO Bioénergies (%)', 'TCH Bioénergies (%)',\n",
       "       'Date_datetime'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Supression des 38 variables flux\n",
    "df=df.drop(df.iloc[:,12:50], axis=1)\n",
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "98368e61",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1734900, 25)"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Controle des dimensions du dataset\n",
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "51b519d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "12"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Création de la variable “Mois” \n",
    "from datetime import datetime as dt\n",
    "df[\"Mois\"]=pd.to_datetime(df.Date).dt.month\n",
    "df.Mois.nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "e41b8bf8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Date', 'Heure', 'Consommation (MW)',\n",
       "       'Thermique (MW)', 'Nucléaire (MW)', 'Eolien (MW)', 'Solaire (MW)',\n",
       "       'Hydraulique (MW)', 'Bioénergies (MW)', 'Ech. physiques (MW)',\n",
       "       'TCO Thermique (%)', 'TCH Thermique (%)', 'TCO Nucléaire (%)',\n",
       "       'TCH Nucléaire (%)', 'TCO Eolien (%)', 'TCH Eolien (%)',\n",
       "       'TCO Solaire (%)', 'TCH Solaire (%)', 'TCO Hydraulique (%)',\n",
       "       'TCH Hydraulique (%)', 'TCO Bioénergies (%)', 'TCH Bioénergies (%)',\n",
       "       'Date_datetime', 'Mois'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Controle du nombre de variables \n",
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "3873d5c2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Eolien (%)</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "      <th>Mois</th>\n",
       "      <th>Date-heure</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3079.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "    Consommation (MW)  Thermique (MW)  Nucléaire (MW)  Eolien (MW)  \\\n",
       "12             3050.0            58.0             NaN        107.0   \n",
       "13             5464.0           240.0          4993.0        175.0   \n",
       "14             9134.0           685.0             NaN         16.0   \n",
       "15             2357.0           236.0             NaN        106.0   \n",
       "16             8173.0           252.0         12069.0        257.0   \n",
       "\n",
       "    Solaire (MW)  Hydraulique (MW)  ...  TCH Eolien (%)  TCO Solaire (%)  \\\n",
       "12           0.0              86.0  ...             NaN              NaN   \n",
       "13           0.0             427.0  ...             NaN              NaN   \n",
       "14           0.0               0.0  ...             NaN              NaN   \n",
       "15           0.0             105.0  ...             NaN              NaN   \n",
       "16           0.0            3079.0  ...             NaN              NaN   \n",
       "\n",
       "    TCH Solaire (%)  TCO Hydraulique (%)  TCH Hydraulique (%)  \\\n",
       "12              NaN                  NaN                  NaN   \n",
       "13              NaN                  NaN                  NaN   \n",
       "14              NaN                  NaN                  NaN   \n",
       "15              NaN                  NaN                  NaN   \n",
       "16              NaN                  NaN                  NaN   \n",
       "\n",
       "    TCO Bioénergies (%)  TCH Bioénergies (%)  Date_datetime  Mois  \\\n",
       "12                  NaN                  NaN     2013-01-01     1   \n",
       "13                  NaN                  NaN     2013-01-01     1   \n",
       "14                  NaN                  NaN     2013-01-01     1   \n",
       "15                  NaN                  NaN     2013-01-01     1   \n",
       "16                  NaN                  NaN     2013-01-01     1   \n",
       "\n",
       "      Date-heure  \n",
       "12  2013-01-01-0  \n",
       "13  2013-01-01-0  \n",
       "14  2013-01-01-0  \n",
       "15  2013-01-01-0  \n",
       "16  2013-01-01-0  \n",
       "\n",
       "[5 rows x 27 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Création de la variable “Date-heure” au format date-1 chiffre\n",
    "df[\"Date-heure\"]=df[\"Date\"] + \"-\" + df[\"Heure\"].astype(str)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "ea8b4dfb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "      <th>Mois</th>\n",
       "      <th>Date-heure</th>\n",
       "      <th>Annee</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3079.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "    Consommation (MW)  Thermique (MW)  Nucléaire (MW)  Eolien (MW)  \\\n",
       "12             3050.0            58.0             NaN        107.0   \n",
       "13             5464.0           240.0          4993.0        175.0   \n",
       "14             9134.0           685.0             NaN         16.0   \n",
       "15             2357.0           236.0             NaN        106.0   \n",
       "16             8173.0           252.0         12069.0        257.0   \n",
       "\n",
       "    Solaire (MW)  Hydraulique (MW)  ...  TCO Solaire (%)  TCH Solaire (%)  \\\n",
       "12           0.0              86.0  ...              NaN              NaN   \n",
       "13           0.0             427.0  ...              NaN              NaN   \n",
       "14           0.0               0.0  ...              NaN              NaN   \n",
       "15           0.0             105.0  ...              NaN              NaN   \n",
       "16           0.0            3079.0  ...              NaN              NaN   \n",
       "\n",
       "    TCO Hydraulique (%)  TCH Hydraulique (%)  TCO Bioénergies (%)  \\\n",
       "12                  NaN                  NaN                  NaN   \n",
       "13                  NaN                  NaN                  NaN   \n",
       "14                  NaN                  NaN                  NaN   \n",
       "15                  NaN                  NaN                  NaN   \n",
       "16                  NaN                  NaN                  NaN   \n",
       "\n",
       "    TCH Bioénergies (%)  Date_datetime  Mois    Date-heure  Annee  \n",
       "12                  NaN     2013-01-01     1  2013-01-01-0   2013  \n",
       "13                  NaN     2013-01-01     1  2013-01-01-0   2013  \n",
       "14                  NaN     2013-01-01     1  2013-01-01-0   2013  \n",
       "15                  NaN     2013-01-01     1  2013-01-01-0   2013  \n",
       "16                  NaN     2013-01-01     1  2013-01-01-0   2013  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Création de la variable “Année” à partir de “Date”\n",
    "df[\"Annee\"]=df.Date_datetime.dt.year\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "41acca23",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Création de la variable “Jour” à partir de “Date_datetime”\n",
    "df[\"Jour_semaine\"]=df.Date_datetime.dt.weekday\n",
    "df.head()\n",
    "df[\"Jour_semaine\"].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2cfb29b8",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "a8768408",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "      <th>Mois</th>\n",
       "      <th>Date-heure</th>\n",
       "      <th>Annee</th>\n",
       "      <th>Jour_semaine</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3079.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "    Consommation (MW)  Thermique (MW)  Nucléaire (MW)  Eolien (MW)  \\\n",
       "12             3050.0            58.0             0.0        107.0   \n",
       "13             5464.0           240.0          4993.0        175.0   \n",
       "14             9134.0           685.0             0.0         16.0   \n",
       "15             2357.0           236.0             0.0        106.0   \n",
       "16             8173.0           252.0         12069.0        257.0   \n",
       "\n",
       "    Solaire (MW)  Hydraulique (MW)  ...  TCH Solaire (%)  TCO Hydraulique (%)  \\\n",
       "12           0.0              86.0  ...              0.0                  0.0   \n",
       "13           0.0             427.0  ...              0.0                  0.0   \n",
       "14           0.0               0.0  ...              0.0                  0.0   \n",
       "15           0.0             105.0  ...              0.0                  0.0   \n",
       "16           0.0            3079.0  ...              0.0                  0.0   \n",
       "\n",
       "    TCH Hydraulique (%)  TCO Bioénergies (%)  TCH Bioénergies (%)  \\\n",
       "12                  0.0                  0.0                  0.0   \n",
       "13                  0.0                  0.0                  0.0   \n",
       "14                  0.0                  0.0                  0.0   \n",
       "15                  0.0                  0.0                  0.0   \n",
       "16                  0.0                  0.0                  0.0   \n",
       "\n",
       "    Date_datetime  Mois    Date-heure  Annee  Jour_semaine  \n",
       "12     2013-01-01     1  2013-01-01-0   2013             1  \n",
       "13     2013-01-01     1  2013-01-01-0   2013             1  \n",
       "14     2013-01-01     1  2013-01-01-0   2013             1  \n",
       "15     2013-01-01     1  2013-01-01-0   2013             1  \n",
       "16     2013-01-01     1  2013-01-01-0   2013             1  \n",
       "\n",
       "[5 rows x 29 columns]"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=df.fillna(0)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "5097e799",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Région</th>\n",
       "      <th>Date</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Date_datetime</th>\n",
       "      <th>Mois</th>\n",
       "      <th>Date-heure</th>\n",
       "      <th>Annee</th>\n",
       "      <th>Jour_semaine</th>\n",
       "      <th>Production_totale</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>53</td>\n",
       "      <td>Bretagne</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>3050.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>107.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>271.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>75</td>\n",
       "      <td>Nouvelle-Aquitaine</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>5464.0</td>\n",
       "      <td>240.0</td>\n",
       "      <td>4993.0</td>\n",
       "      <td>175.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>5977.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11</td>\n",
       "      <td>Île-de-France</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>9134.0</td>\n",
       "      <td>685.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>843.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>27</td>\n",
       "      <td>Bourgogne-Franche-Comté</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>2357.0</td>\n",
       "      <td>236.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>106.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>459.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>84</td>\n",
       "      <td>Auvergne-Rhône-Alpes</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>0</td>\n",
       "      <td>8173.0</td>\n",
       "      <td>252.0</td>\n",
       "      <td>12069.0</td>\n",
       "      <td>257.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3079.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01</td>\n",
       "      <td>1</td>\n",
       "      <td>2013-01-01-0</td>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>15725.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Code INSEE région                   Région        Date  Heure  \\\n",
       "12                 53                 Bretagne  2013-01-01      0   \n",
       "13                 75       Nouvelle-Aquitaine  2013-01-01      0   \n",
       "14                 11            Île-de-France  2013-01-01      0   \n",
       "15                 27  Bourgogne-Franche-Comté  2013-01-01      0   \n",
       "16                 84     Auvergne-Rhône-Alpes  2013-01-01      0   \n",
       "\n",
       "    Consommation (MW)  Thermique (MW)  Nucléaire (MW)  Eolien (MW)  \\\n",
       "12             3050.0            58.0             0.0        107.0   \n",
       "13             5464.0           240.0          4993.0        175.0   \n",
       "14             9134.0           685.0             0.0         16.0   \n",
       "15             2357.0           236.0             0.0        106.0   \n",
       "16             8173.0           252.0         12069.0        257.0   \n",
       "\n",
       "    Solaire (MW)  Hydraulique (MW)  ...  TCO Hydraulique (%)  \\\n",
       "12           0.0              86.0  ...                  0.0   \n",
       "13           0.0             427.0  ...                  0.0   \n",
       "14           0.0               0.0  ...                  0.0   \n",
       "15           0.0             105.0  ...                  0.0   \n",
       "16           0.0            3079.0  ...                  0.0   \n",
       "\n",
       "    TCH Hydraulique (%)  TCO Bioénergies (%)  TCH Bioénergies (%)  \\\n",
       "12                  0.0                  0.0                  0.0   \n",
       "13                  0.0                  0.0                  0.0   \n",
       "14                  0.0                  0.0                  0.0   \n",
       "15                  0.0                  0.0                  0.0   \n",
       "16                  0.0                  0.0                  0.0   \n",
       "\n",
       "    Date_datetime  Mois    Date-heure  Annee  Jour_semaine  Production_totale  \n",
       "12     2013-01-01     1  2013-01-01-0   2013             1              271.0  \n",
       "13     2013-01-01     1  2013-01-01-0   2013             1             5977.0  \n",
       "14     2013-01-01     1  2013-01-01-0   2013             1              843.0  \n",
       "15     2013-01-01     1  2013-01-01-0   2013             1              459.0  \n",
       "16     2013-01-01     1  2013-01-01-0   2013             1            15725.0  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Création de la variable “Production_totale” à partir des variables par filière MW\n",
    "df[\"Production_totale\"]=df[\"Thermique (MW)\"]+df[\"Nucléaire (MW)\"]+df[\"Eolien (MW)\"]+df[\"Solaire (MW)\"]+df[\"Hydraulique (MW)\"]+df[\"Bioénergies (MW)\"]\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bc82d78",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "4f628225",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1734900, 30)"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "313f6e09",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Code INSEE région', 'Région', 'Date', 'Heure', 'Consommation (MW)',\n",
       "       'Thermique (MW)', 'Nucléaire (MW)', 'Eolien (MW)', 'Solaire (MW)',\n",
       "       'Hydraulique (MW)', 'Bioénergies (MW)', 'Ech. physiques (MW)',\n",
       "       'TCO Thermique (%)', 'TCH Thermique (%)', 'TCO Nucléaire (%)',\n",
       "       'TCH Nucléaire (%)', 'TCO Eolien (%)', 'TCH Eolien (%)',\n",
       "       'TCO Solaire (%)', 'TCH Solaire (%)', 'TCO Hydraulique (%)',\n",
       "       'TCH Hydraulique (%)', 'TCO Bioénergies (%)', 'TCH Bioénergies (%)',\n",
       "       'Date_datetime', 'Mois', 'Date-heure', 'Annee', 'Jour_semaine',\n",
       "       'Production_totale'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "6a11108d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code INSEE région</th>\n",
       "      <th>Heure</th>\n",
       "      <th>Consommation (MW)</th>\n",
       "      <th>Thermique (MW)</th>\n",
       "      <th>Nucléaire (MW)</th>\n",
       "      <th>Eolien (MW)</th>\n",
       "      <th>Solaire (MW)</th>\n",
       "      <th>Hydraulique (MW)</th>\n",
       "      <th>Bioénergies (MW)</th>\n",
       "      <th>Ech. physiques (MW)</th>\n",
       "      <th>...</th>\n",
       "      <th>TCO Solaire (%)</th>\n",
       "      <th>TCH Solaire (%)</th>\n",
       "      <th>TCO Hydraulique (%)</th>\n",
       "      <th>TCH Hydraulique (%)</th>\n",
       "      <th>TCO Bioénergies (%)</th>\n",
       "      <th>TCH Bioénergies (%)</th>\n",
       "      <th>Mois</th>\n",
       "      <th>Annee</th>\n",
       "      <th>Jour_semaine</th>\n",
       "      <th>Production_totale</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>...</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.00</td>\n",
       "      <td>1734900.0</td>\n",
       "      <td>1734900.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>49.92</td>\n",
       "      <td>11.50</td>\n",
       "      <td>4515.62</td>\n",
       "      <td>378.69</td>\n",
       "      <td>3694.25</td>\n",
       "      <td>244.42</td>\n",
       "      <td>83.21</td>\n",
       "      <td>608.48</td>\n",
       "      <td>81.52</td>\n",
       "      <td>-508.93</td>\n",
       "      <td>...</td>\n",
       "      <td>0.41</td>\n",
       "      <td>1.88</td>\n",
       "      <td>1.80</td>\n",
       "      <td>4.28</td>\n",
       "      <td>0.33</td>\n",
       "      <td>7.98</td>\n",
       "      <td>6.39</td>\n",
       "      <td>2016.64</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5090.56</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>25.64</td>\n",
       "      <td>6.92</td>\n",
       "      <td>2182.80</td>\n",
       "      <td>541.19</td>\n",
       "      <td>3892.71</td>\n",
       "      <td>409.87</td>\n",
       "      <td>203.17</td>\n",
       "      <td>1040.03</td>\n",
       "      <td>44.73</td>\n",
       "      <td>4388.92</td>\n",
       "      <td>...</td>\n",
       "      <td>2.59</td>\n",
       "      <td>9.01</td>\n",
       "      <td>7.92</td>\n",
       "      <td>12.62</td>\n",
       "      <td>0.84</td>\n",
       "      <td>19.90</td>\n",
       "      <td>3.49</td>\n",
       "      <td>2.38</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4590.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>11.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>895.00</td>\n",
       "      <td>-83.00</td>\n",
       "      <td>-144.00</td>\n",
       "      <td>-6.00</td>\n",
       "      <td>-23.00</td>\n",
       "      <td>-6.00</td>\n",
       "      <td>4.00</td>\n",
       "      <td>-12219.00</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.08</td>\n",
       "      <td>-0.12</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.00</td>\n",
       "      <td>2013.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>-5.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>27.75</td>\n",
       "      <td>6.00</td>\n",
       "      <td>2800.00</td>\n",
       "      <td>26.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>26.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.00</td>\n",
       "      <td>46.00</td>\n",
       "      <td>-4282.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.00</td>\n",
       "      <td>2015.00</td>\n",
       "      <td>1.0</td>\n",
       "      <td>645.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>48.00</td>\n",
       "      <td>12.00</td>\n",
       "      <td>4124.00</td>\n",
       "      <td>157.00</td>\n",
       "      <td>2583.00</td>\n",
       "      <td>100.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>57.00</td>\n",
       "      <td>71.00</td>\n",
       "      <td>485.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.00</td>\n",
       "      <td>2017.00</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4344.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>75.25</td>\n",
       "      <td>18.00</td>\n",
       "      <td>5763.00</td>\n",
       "      <td>491.00</td>\n",
       "      <td>6910.00</td>\n",
       "      <td>287.00</td>\n",
       "      <td>60.00</td>\n",
       "      <td>898.00</td>\n",
       "      <td>114.00</td>\n",
       "      <td>2239.00</td>\n",
       "      <td>...</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>9.00</td>\n",
       "      <td>2019.00</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8114.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>93.00</td>\n",
       "      <td>23.00</td>\n",
       "      <td>15338.00</td>\n",
       "      <td>4293.00</td>\n",
       "      <td>13632.00</td>\n",
       "      <td>4554.00</td>\n",
       "      <td>2198.00</td>\n",
       "      <td>8742.00</td>\n",
       "      <td>404.00</td>\n",
       "      <td>13959.00</td>\n",
       "      <td>...</td>\n",
       "      <td>54.18</td>\n",
       "      <td>103.25</td>\n",
       "      <td>115.57</td>\n",
       "      <td>92.73</td>\n",
       "      <td>7.33</td>\n",
       "      <td>86.05</td>\n",
       "      <td>12.00</td>\n",
       "      <td>2021.00</td>\n",
       "      <td>6.0</td>\n",
       "      <td>22146.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Code INSEE région       Heure  Consommation (MW)  Thermique (MW)  \\\n",
       "count         1734900.00  1734900.00         1734900.00      1734900.00   \n",
       "mean               49.92       11.50            4515.62          378.69   \n",
       "std                25.64        6.92            2182.80          541.19   \n",
       "min                11.00        0.00             895.00          -83.00   \n",
       "25%                27.75        6.00            2800.00           26.00   \n",
       "50%                48.00       12.00            4124.00          157.00   \n",
       "75%                75.25       18.00            5763.00          491.00   \n",
       "max                93.00       23.00           15338.00         4293.00   \n",
       "\n",
       "       Nucléaire (MW)  Eolien (MW)  Solaire (MW)  Hydraulique (MW)  \\\n",
       "count      1734900.00   1734900.00    1734900.00        1734900.00   \n",
       "mean          3694.25       244.42         83.21            608.48   \n",
       "std           3892.71       409.87        203.17           1040.03   \n",
       "min           -144.00        -6.00        -23.00             -6.00   \n",
       "25%              0.00        26.00          0.00              5.00   \n",
       "50%           2583.00       100.00          0.00             57.00   \n",
       "75%           6910.00       287.00         60.00            898.00   \n",
       "max          13632.00      4554.00       2198.00           8742.00   \n",
       "\n",
       "       Bioénergies (MW)  Ech. physiques (MW)  ...  TCO Solaire (%)  \\\n",
       "count        1734900.00           1734900.00  ...       1734900.00   \n",
       "mean              81.52              -508.93  ...             0.41   \n",
       "std               44.73              4388.92  ...             2.59   \n",
       "min                4.00            -12219.00  ...            -0.08   \n",
       "25%               46.00             -4282.00  ...             0.00   \n",
       "50%               71.00               485.00  ...             0.00   \n",
       "75%              114.00              2239.00  ...             0.00   \n",
       "max              404.00             13959.00  ...            54.18   \n",
       "\n",
       "       TCH Solaire (%)  TCO Hydraulique (%)  TCH Hydraulique (%)  \\\n",
       "count       1734900.00           1734900.00           1734900.00   \n",
       "mean              1.88                 1.80                 4.28   \n",
       "std               9.01                 7.92                12.62   \n",
       "min              -0.12                 0.00                 0.00   \n",
       "25%               0.00                 0.00                 0.00   \n",
       "50%               0.00                 0.00                 0.00   \n",
       "75%               0.00                 0.00                 0.00   \n",
       "max             103.25               115.57                92.73   \n",
       "\n",
       "       TCO Bioénergies (%)  TCH Bioénergies (%)        Mois       Annee  \\\n",
       "count           1734900.00           1734900.00  1734900.00  1734900.00   \n",
       "mean                  0.33                 7.98        6.39     2016.64   \n",
       "std                   0.84                19.90        3.49        2.38   \n",
       "min                   0.00                 0.00        1.00     2013.00   \n",
       "25%                   0.00                 0.00        3.00     2015.00   \n",
       "50%                   0.00                 0.00        6.00     2017.00   \n",
       "75%                   0.00                 0.00        9.00     2019.00   \n",
       "max                   7.33                86.05       12.00     2021.00   \n",
       "\n",
       "       Jour_semaine  Production_totale  \n",
       "count     1734900.0         1734900.00  \n",
       "mean            3.0            5090.56  \n",
       "std             2.0            4590.44  \n",
       "min             0.0              -5.00  \n",
       "25%             1.0             645.00  \n",
       "50%             3.0            4344.00  \n",
       "75%             5.0            8114.00  \n",
       "max             6.0           22146.00  \n",
       "\n",
       "[8 rows x 26 columns]"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe().round(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "182b4327",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Code INSEE région      0\n",
       "Région                 0\n",
       "Date                   0\n",
       "Heure                  0\n",
       "Consommation (MW)      0\n",
       "Thermique (MW)         0\n",
       "Nucléaire (MW)         0\n",
       "Eolien (MW)            0\n",
       "Solaire (MW)           0\n",
       "Hydraulique (MW)       0\n",
       "Bioénergies (MW)       0\n",
       "Ech. physiques (MW)    0\n",
       "TCO Thermique (%)      0\n",
       "TCH Thermique (%)      0\n",
       "TCO Nucléaire (%)      0\n",
       "TCH Nucléaire (%)      0\n",
       "TCO Eolien (%)         0\n",
       "TCH Eolien (%)         0\n",
       "TCO Solaire (%)        0\n",
       "TCH Solaire (%)        0\n",
       "TCO Hydraulique (%)    0\n",
       "TCH Hydraulique (%)    0\n",
       "TCO Bioénergies (%)    0\n",
       "TCH Bioénergies (%)    0\n",
       "Date_datetime          0\n",
       "Mois                   0\n",
       "Date-heure             0\n",
       "Annee                  0\n",
       "Jour_semaine           0\n",
       "Production_totale      0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "36f5f45d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 1734900 entries, 12 to 1734911\n",
      "Data columns (total 30 columns):\n",
      " #   Column               Dtype         \n",
      "---  ------               -----         \n",
      " 0   Code INSEE région    int64         \n",
      " 1   Région               object        \n",
      " 2   Date                 object        \n",
      " 3   Heure                int64         \n",
      " 4   Consommation (MW)    float64       \n",
      " 5   Thermique (MW)       float64       \n",
      " 6   Nucléaire (MW)       float64       \n",
      " 7   Eolien (MW)          float64       \n",
      " 8   Solaire (MW)         float64       \n",
      " 9   Hydraulique (MW)     float64       \n",
      " 10  Bioénergies (MW)     float64       \n",
      " 11  Ech. physiques (MW)  float64       \n",
      " 12  TCO Thermique (%)    float64       \n",
      " 13  TCH Thermique (%)    float64       \n",
      " 14  TCO Nucléaire (%)    float64       \n",
      " 15  TCH Nucléaire (%)    float64       \n",
      " 16  TCO Eolien (%)       float64       \n",
      " 17  TCH Eolien (%)       float64       \n",
      " 18  TCO Solaire (%)      float64       \n",
      " 19  TCH Solaire (%)      float64       \n",
      " 20  TCO Hydraulique (%)  float64       \n",
      " 21  TCH Hydraulique (%)  float64       \n",
      " 22  TCO Bioénergies (%)  float64       \n",
      " 23  TCH Bioénergies (%)  float64       \n",
      " 24  Date_datetime        datetime64[ns]\n",
      " 25  Mois                 int64         \n",
      " 26  Date-heure           object        \n",
      " 27  Annee                int64         \n",
      " 28  Jour_semaine         int64         \n",
      " 29  Production_totale    float64       \n",
      "dtypes: datetime64[ns](1), float64(21), int64(5), object(3)\n",
      "memory usage: 410.3+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "d52f433e",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv (path_or_buf= \"df_nettoyé_2.csv\",\n",
    "                 sep= \";\",\n",
    "                 header= True)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
